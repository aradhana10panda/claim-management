<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ClaimMapper.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">claim-management-service</a> &gt; <a href="index.source.html" class="el_package">com.claimmanagement.mapper</a> &gt; <span class="el_source">ClaimMapper.java</span></div><h1>ClaimMapper.java</h1><pre class="source lang-java linenums">package com.claimmanagement.mapper;

import com.claimmanagement.model.dto.ClaimRequestDto;
import com.claimmanagement.model.dto.ClaimResponseDto;
import com.claimmanagement.model.entity.Claim;
import org.mapstruct.*;

import java.util.List;

/**
 * MapStruct Mapper Interface for Claim Entity and DTOs
 * 
 * MapStruct is a compile-time code generator that creates mapping implementations
 * 
 * Benefits of MapStruct:
 * 1. Performance: Generates plain Java code (no reflection)
 * 2. Type Safety: Compile-time checking of mappings
 * 3. IDE Support: Auto-completion and refactoring support
 * 4. Maintainability: Clear mapping definitions
 * 5. Debugging: Generated code is readable and debuggable
 * 
 * How MapStruct Works:
 * 1. Annotation processor runs during compilation
 * 2. Generates implementation class (ClaimMapperImpl)
 * 3. Spring finds and injects the generated implementation
 * 4. Mappings are based on matching property names
 * 5. Custom mappings can be defined with @Mapping annotations
 * 
 * @Mapper Annotation Parameters:
 * - componentModel = &quot;spring&quot;: Generates Spring component (@Component)
 * - unmappedTargetPolicy = ReportingPolicy.IGNORE: Ignores unmapped target properties
 * - nullValuePropertyMappingStrategy: How to handle null values
 * 
 * @author Claim Management Team
 */
@Mapper(
    componentModel = &quot;spring&quot;,                                    // Generate Spring component
    unmappedTargetPolicy = ReportingPolicy.IGNORE,              // Ignore unmapped properties
    nullValuePropertyMappingStrategy = NullValuePropertyMappingStrategy.IGNORE  // Ignore null values
)
public interface ClaimMapper {

    /**
     * Maps ClaimRequestDto to Claim entity for creation
     * 
     * @Mapping annotations specify custom mapping rules:
     * - target: Property name in target object (Claim)
     * - ignore = true: Skip mapping this property
     * 
     * Ignored properties for creation:
     * - id: Auto-generated by database
     * - claimNumber: Generated by service layer
     * - createdAt: Set by @CreationTimestamp
     * - updatedAt: Set by @UpdateTimestamp
     * 
     * @param requestDto The request DTO containing claim data
     * @return New Claim entity (without system-generated fields)
     */
    @Mapping(target = &quot;id&quot;, ignore = true)
    @Mapping(target = &quot;claimNumber&quot;, ignore = true)
    @Mapping(target = &quot;createdAt&quot;, ignore = true)
    @Mapping(target = &quot;updatedAt&quot;, ignore = true)
    Claim toEntity(ClaimRequestDto requestDto);

    /**
     * Maps Claim entity to ClaimResponseDto
     * 
     * All properties are mapped automatically based on matching names
     * No custom mappings needed as all entity properties should be included in response
     * 
     * @param claim The claim entity from database
     * @return Response DTO with all claim information
     */
    @Named(&quot;toResponseDto&quot;)
    ClaimResponseDto toResponseDto(Claim claim);

    /**
     * Maps list of Claim entities to list of ClaimResponseDtos
     * 
     * MapStruct automatically generates this method based on the single entity mapping
     * Very useful for returning multiple claims (search results, etc.)
     * 
     * @param claims List of claim entities
     * @return List of response DTOs
     */
    @IterableMapping(qualifiedByName = &quot;toResponseDto&quot;)
    List&lt;ClaimResponseDto&gt; toResponseDtoList(List&lt;Claim&gt; claims);

    /**
     * Updates existing Claim entity with data from ClaimRequestDto
     * 
     * @MappingTarget annotation indicates the target object to update
     * This is useful for PATCH/PUT operations where you want to update existing entity
     * 
     * Ignored properties for updates:
     * - id: Should never change
     * - claimNumber: Business key, should not change
     * - createdAt: Historical data, should not change
     * - updatedAt: Automatically updated by @UpdateTimestamp
     * 
     * Null value strategy ensures null values in DTO don't overwrite existing entity values
     * This enables partial updates (PATCH semantics)
     * 
     * @param requestDto The request DTO with updated data
     * @param claim The existing claim entity to update
     */
    @Mapping(target = &quot;id&quot;, ignore = true)
    @Mapping(target = &quot;claimNumber&quot;, ignore = true)
    @Mapping(target = &quot;createdAt&quot;, ignore = true)
    @Mapping(target = &quot;updatedAt&quot;, ignore = true)
    void updateEntityFromDto(ClaimRequestDto requestDto, @MappingTarget Claim claim);

    /**
     * Custom mapping method for status updates only
     * 
     * Sometimes you need to update only specific fields
     * This method demonstrates how to create specialized mapping methods
     * 
     * @param claim The claim entity to convert
     * @return Response DTO with minimal information for status updates
     */
    @Named(&quot;toStatusResponseDto&quot;)
    @Mapping(target = &quot;claimantPhone&quot;, ignore = true)
    @Mapping(target = &quot;description&quot;, ignore = true)
    ClaimResponseDto toStatusResponseDto(Claim claim);

    /**
     * After-mapping method to perform custom logic after automatic mapping
     * 
     * @AfterMapping annotation indicates this method runs after the main mapping
     * Useful for:
     * - Complex calculations
     * - Setting derived properties
     * - Validation
     * - Logging
     * 
     * Example: Set default status if not provided in request
     * 
     * @param requestDto Source DTO
     * @param claim Target entity
     */
    @AfterMapping
    default void setDefaultValues(ClaimRequestDto requestDto, @MappingTarget Claim claim) {
        // Set default status to SUBMITTED if not provided
<span class="fc bfc" id="L145" title="All 2 branches covered.">        if (claim.getStatus() == null) {</span>
<span class="fc" id="L146">            claim.setStatus(com.claimmanagement.model.entity.ClaimStatus.SUBMITTED);</span>
        }
<span class="fc" id="L148">    }</span>

    /**
     * Before-mapping method to perform validation or preprocessing
     * 
     * @BeforeMapping annotation indicates this method runs before the main mapping
     * Useful for:
     * - Input validation
     * - Data preprocessing
     * - Logging
     * 
     * @param requestDto Source DTO to validate
     */
    @BeforeMapping
    default void validateRequest(ClaimRequestDto requestDto) {
        // Custom validation logic can be added here
        // For example, business rule validations that go beyond bean validation
<span class="fc bfc" id="L165" title="All 4 branches covered.">        if (requestDto != null &amp;&amp; requestDto.getClaimAmount() != null) {</span>
            // Log high-value claims for additional review
<span class="pc bpc" id="L167" title="1 of 2 branches missed.">            if (requestDto.getClaimAmount().compareTo(java.math.BigDecimal.valueOf(100000)) &gt; 0) {</span>
<span class="nc" id="L168">                System.out.println(&quot;High-value claim detected: &quot; + requestDto.getClaimAmount());</span>
            }
        }
<span class="fc" id="L171">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>